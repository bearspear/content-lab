<div class="flac-player-container"
     [class.drag-over]="isDragOver"
     (dragover)="onDragOver($event)"
     (dragleave)="onDragLeave($event)"
     (drop)="onDrop($event)">
  <!-- Header -->
  <div class="header">
    <div class="header-content">
      <div class="title-section">
        <h1 class="title">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="title-icon">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"/>
          </svg>
          FLAC Player
        </h1>
        <p class="subtitle">High-quality audio player with CUE sheet support</p>
      </div>
      <button class="browse-files-btn" (click)="fileInput.click()" title="Browse files">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
        </svg>
      </button>
      <input #fileInput
             type="file"
             accept=".flac,.cue,.mp3,.wav"
             multiple
             style="display: none;"
             (change)="onFileSelect($event)">
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Empty State (shown when no audio is loaded) -->
    <div class="empty-state" *ngIf="!hasAudioLoaded && playlist.length === 0">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="empty-icon">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"/>
      </svg>
      <h2 class="empty-title">No audio loaded</h2>
      <p class="empty-description">Drop FLAC files, MP3, WAV, or CUE sheets anywhere on the player</p>
      <p class="empty-hint">or click the <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="inline-icon"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg> icon above</p>
    </div>

    <!-- Player Controls (shown when audio is loaded) -->
    <div class="player-section" *ngIf="hasAudioLoaded">
      <div class="now-playing">
        <!-- Album Artwork -->
        <div class="album-art">
          <img *ngIf="currentTrack?.albumArt"
               [src]="currentTrack?.albumArt"
               alt="Album artwork"
               class="album-art-image">
          <div *ngIf="!currentTrack?.albumArt" class="album-art-placeholder">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"/>
            </svg>
          </div>
        </div>
        <!-- Track Info -->
        <div class="track-info">
          <h3 class="track-title">{{ currentTrack?.title || 'Unknown Track' }}</h3>
          <p class="track-artist">{{ currentTrack?.artist || 'Unknown Artist' }}</p>
          <p class="track-album" *ngIf="currentTrack?.album">{{ currentTrack?.album }}</p>
          <p class="track-meta-info" *ngIf="currentTrack?.year || currentTrack?.genre">
            <span *ngIf="currentTrack?.year">{{ currentTrack?.year }}</span>
            <span *ngIf="currentTrack?.year && currentTrack?.genre"> â€¢ </span>
            <span *ngIf="currentTrack?.genre">{{ currentTrack?.genre }}</span>
          </p>
        </div>
      </div>

      <!-- Audio Controls -->
      <div class="controls">
        <button class="control-btn" (click)="previousTrack()" [disabled]="!hasPreviousTrack()">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7m8 14l-7-7 7-7"/>
          </svg>
        </button>

        <button class="control-btn play-pause-btn" (click)="togglePlayPause()">
          <svg *ngIf="!isPlaying" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M8 5v14l11-7z"/>
          </svg>
          <svg *ngIf="isPlaying" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>
          </svg>
        </button>

        <button class="control-btn" (click)="nextTrack()" [disabled]="!hasNextTrack()">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 5l7 7-7 7"/>
          </svg>
        </button>
      </div>

      <!-- Progress Bar -->
      <div class="progress-section">
        <span class="time-label">{{ formatTime(currentTime) }}</span>
        <div class="progress-bar" (click)="seekTo($event)">
          <div class="progress-fill" [style.width.%]="progressPercentage"></div>
        </div>
        <span class="time-label">{{ formatTime(duration) }}</span>
      </div>

      <!-- Volume Control -->
      <div class="volume-section">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="volume-icon">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"/>
        </svg>
        <input type="range"
               min="0"
               max="100"
               [(ngModel)]="volume"
               (input)="onVolumeChange()"
               class="volume-slider">
        <span class="volume-label">{{ volume }}%</span>
      </div>
    </div>

    <!-- Playlist (shown when tracks are loaded) -->
    <div class="playlist-section" *ngIf="playlist.length > 0">
      <div class="playlist-header">
        <h3 class="playlist-title">Playlist ({{ playlist.length }} tracks)</h3>
        <div class="playlist-actions">
          <button class="export-playlist-btn" (click)="exportPlaylistAsM3U()" title="Export playlist as M3U">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
            </svg>
            Export M3U
          </button>
          <button class="clear-playlist-btn" (click)="clearPlaylist()" title="Clear all tracks">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
            </svg>
            Clear All
          </button>
        </div>
      </div>
      <ul class="playlist">
        <li *ngFor="let track of playlist; let i = index"
            class="playlist-item"
            [class.active]="i === currentTrackIndex"
            (click)="playTrack(i)">
          <div class="track-number">{{ i + 1 }}</div>
          <div class="track-details">
            <div class="track-name">{{ track.title || track.filename }}</div>
            <div class="track-meta">
              <span *ngIf="track.artist">{{ track.artist }}</span>
              <span *ngIf="track.duration" class="track-duration">{{ formatTime(track.duration) }}</span>
            </div>
          </div>
          <div class="track-actions">
            <svg *ngIf="i === currentTrackIndex && isPlaying"
                 xmlns="http://www.w3.org/2000/svg"
                 viewBox="0 0 24 24"
                 fill="currentColor"
                 class="playing-icon">
              <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>
            </svg>
            <button class="remove-track-btn"
                    (click)="removeTrack(i, $event)"
                    title="Remove track">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
              </svg>
            </button>
          </div>
        </li>
      </ul>
    </div>
  </div>
</div>
